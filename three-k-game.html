<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¼êµ­ì§€ ë•…ë”°ë¨¹ê¸° - ì „ëµ ì‹œë®¬ë ˆì´ì…˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', Arial, sans-serif;
            background: linear-gradient(135deg, #2c1810 0%, #8b4513 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }

        .game-container {
            max-width: 1400px;
            margin: 0 auto;
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 20px;
            align-items: start;
        }

        .left-panel, .right-panel {
            background: rgba(0,0,0,0.4);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #8b4513;
        }

        .center-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .faction-selector {
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            border: 2px solid #8b4513;
        }

        .faction-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .faction-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .faction-btn.wei {
            background: linear-gradient(45deg, #4169e1, #6495ed);
            color: white;
        }

        .faction-btn.shu {
            background: linear-gradient(45deg, #dc143c, #ff6b6b);
            color: white;
        }

        .faction-btn.wu {
            background: linear-gradient(45deg, #228b22, #90ee90);
            color: white;
        }

        .faction-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .faction-btn.selected {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255,215,0,0.5);
        }

        .stats-panel {
            margin-bottom: 20px;
        }

        .stats-panel h3 {
            margin-bottom: 15px;
            color: #ffd700;
            text-align: center;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }

        .stat-name {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-value {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .stat-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
		}
		
		.play-bangbeob {
			display: flex;
			width: 100%;
			top: 10px;
			padding: 5px;
			background: rgba(255,255,255,0.1);
			border-radius: 5px;
		}
		
		
        .stat-fill {
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }
		
		

        .military { background: linear-gradient(90deg, #dc143c, #ff6b6b); }
        .economy { background: linear-gradient(90deg, #ffd700, #ffed4e); }
        .culture { background: linear-gradient(90deg, #9370db, #dda0dd); }

        .events-panel h3 {
            margin-bottom: 15px;
            color: #ffd700;
            text-align: center;
        }

        .event-item {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #ffd700;
        }

        .event-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #ffd700;
        }

        .event-description {
            font-size: 0.9rem;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .event-effects {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .effect {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .effect.positive { background: rgba(34, 197, 94, 0.3); color: #22c55e; }
        .effect.negative { background: rgba(239, 68, 68, 0.3); color: #ef4444; }

        .map-container {
            background: rgba(0,0,0,0.4);
            padding: 20px;
            border-radius: 15px;
            border: 3px solid #8b4513;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .game-map {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 2px;
            background: #2c1810;
            padding: 10px;
            border-radius: 10px;
        }

        .territory {
            width: 45px;
            height: 45px;
            border: 1px solid #8b4513;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
        }

        .territory:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 0 15px rgba(255,215,0,0.8);
        }

        .territory.wei {
            background: linear-gradient(135deg, #4169e1, #1e3a8a);
            color: white;
        }

        .territory.shu {
            background: linear-gradient(135deg, #dc143c, #991b1b);
            color: white;
        }

        .territory.wu {
            background: linear-gradient(135deg, #228b22, #166534);
            color: white;
        }

        .territory.neutral {
            background: linear-gradient(135deg, #6b7280, #374151);
            color: #d1d5db;
        }

        .territory.capturable {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 5px rgba(255,215,0,0.5); }
            50% { box-shadow: 0 0 20px rgba(255,215,0,1); }
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(45deg, #8b4513, #a0522d);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: linear-gradient(45deg, #a0522d, #cd853f);
            transform: translateY(-2px);
        }

        .status-message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.3);
        }

        .territory-info h3 {
            margin-bottom: 15px;
            color: #ffd700;
            text-align: center;
        }

        .territory-count {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }

        .faction-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            border: 1px solid #fff;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .territory {
                width: 35px;
                height: 35px;
                font-size: 0.6rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸ›ï¸ ì‚¼êµ­ì§€ ì „ëµ ì‹œë®¬ë ˆì´ì…˜ ğŸ›ï¸</h1>
        
        <div class="faction-selector">
            <h3 style="margin-bottom: 15px;">ì§„ì˜ì„ ì„ íƒí•˜ì„¸ìš”</h3>
            <div class="faction-buttons">
                <button class="faction-btn wei" onclick="selectFaction('wei')">ìœ„(é­) ì¡°ì¡°</button>
                <button class="faction-btn shu" onclick="selectFaction('shu')">ì´‰(èœ€) ìœ ë¹„</button>
                <button class="faction-btn wu" onclick="selectFaction('wu')">ì˜¤(å³) ì†ê¶Œ</button>
            </div>
        </div>

        <div class="main-content">
            <div class="left-panel">
                <div class="stats-panel">
                    <h3>ğŸ“Š ì§„ì˜ë³„ ëŠ¥ë ¥ì¹˜</h3>
                    <div id="factionStats"></div>
                </div>
                
                <div class="territory-info">
                    <h3>ğŸ—ºï¸ ì˜í†  í˜„í™©</h3>
                    <div class="territory-count">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div class="faction-color" style="background: linear-gradient(45deg, #4169e1, #1e3a8a);"></div>
                            <span>ìœ„</span>
                        </div>
                        <span id="wei-count">48</span>
                    </div>
                    <div class="territory-count">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div class="faction-color" style="background: linear-gradient(45deg, #dc143c, #991b1b);"></div>
                            <span>ì´‰</span>
                        </div>
                        <span id="shu-count">48</span>
                    </div>
                    <div class="territory-count">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div class="faction-color" style="background: linear-gradient(45deg, #228b22, #166534);"></div>
                            <span>ì˜¤</span>
                        </div>
                        <span id="wu-count">48</span>
                    </div>
                </div>
            </div>

            <div class="center-panel">
				<div class="status-message" id="statusMessage">
                    ì§„ì˜ì„ ì„ íƒí•˜ê³  ì „ëµì„ ì„¸ì›Œë³´ì„¸ìš”!
                </div>
				
                <div class="map-container">
                    <div class="game-map" id="gameMap"></div>
                </div>
                
                <div class="controls">
                    <button class="control-btn" onclick="resetGame()">ê²Œì„ ì´ˆê¸°í™”</button>
                    <button class="control-btn" onclick="nextTurn()">ë‹¤ìŒ í„´</button>
                    <button class="control-btn" onclick="autoPlay()">ìë™ ì§„í–‰</button>
                </div>

                
            </div>
			
			<div class="play-bangbeob">
				<h3>í•˜ëŠ”ë²•</h3>
				ìµœìƒë‹¨ì˜ íŒŒë‘, ë¹¨ê°•, ì´ˆë¡ì˜ ì„¸ ë²„íŠ¼ ì¤‘ í•˜ë‚˜ë¥¼ í´ë¦­í•´ íŒ€ì„ ì„ íƒí•©ë‹ˆë‹¤.<br>
				íŒ€ ì„ íƒ ë²„íŠ¼ ë°‘ì— ìˆëŠ” ê²ƒì´ ë§µì…ë‹ˆë‹¤.<br>
				ì„ íƒí•œ íŒ€ì˜ ìƒ‰ê¹”ì˜ ë•…ì´ ì§€ê¸ˆ ê°€ì§€ê³  ìˆëŠ” ë•…ì´ë©°,<br>ë…¸ë€ìƒ‰ìœ¼ë¡œ ì€ì€í•˜ê²Œ ë¹›ë‚˜ëŠ” ë•…ì„ í´ë¦­í•˜ë©´ ê·¸ ê³³ì„ ê³µê²©í•©ë‹ˆë‹¤.<br>
				êµ°ì‚¬ë ¥ì— ë”°ë¼ì„œ ëœë¤ìœ¼ë¡œ ê³µê²©ì˜ ì„±íŒ¨ê°€ ê°ˆë¦½ë‹ˆë‹¤. 60% ì´ìƒì˜ ë•…ì„ ë¨¹ìœ¼ë©´ ìŠ¹ë¦¬!
			</div>
			
            <div class="right-panel">
                <div class="events-panel">
                    <h3>ğŸ“œ ìµœê·¼ ì‚¬ê±´</h3>
                    <div id="eventsList"></div>
                </div>
            </div>
			
        </div>
    </div>

    <script>
        // ì‹¤ì œ í•œë‚˜ë¼ ì§€ëª… 144ê°œ
        const territories = [
            'ë‚™ì–‘', 'ì¥ì•ˆ', 'ì—…ì„±', 'ì™„ì„±', 'í—ˆì°½', 'ì§„ë¥˜', 'ê°œë´‰', 'ì •ì£¼',
            'ì–‘ì£¼', 'ì„œì£¼', 'ì—°ì£¼', 'ê¸°ì£¼', 'ì²­ì£¼', 'ìœ ì£¼', 'ë³‘ì£¼', 'ì˜¹ì£¼',
            'ì–‘ì–‘', 'ê°•ë¦‰', 'ë¬´ì°½', 'ê±´ì—…', 'íšŒê³„', 'ì˜¤êµ°', 'ë‹¨ì–‘', 'ì—¬ë‚¨',
            'ì—¬ê°•', 'êµ¬ê°•', 'ì‹œìƒ', 'ì¥ì‚¬', 'ê³„ì–‘', 'ì˜ë¦‰', 'ë¬´ë¦‰', 'ì˜ì²œ',
            'ì„±ë„', 'í•œì¤‘', 'íŒŒêµ°', 'ê´‘í•œ', 'ì´‰êµ°', 'ê±´ìœ„', 'ì›”ìˆ˜', 'ì˜ì°½',
            'ê±´ë…•', 'ìš´ë‚¨', 'ìµì£¼', 'ëŸ‰ì£¼', 'ë¬´ë„', 'ìŒí‰', 'ì²œìˆ˜', 'ì„œí‰',
            'ì•ˆì •', 'ë¶ì§€', 'ìƒêµ°', 'í’ìµ', 'ë¶€í’', 'ê²½ì¡°', 'ì¢Œí’ìµ', 'ìš°ë¶€í’',
            'í•˜ë™', 'í•˜ë‚´', 'ìƒë‹¹', 'íƒœì›', 'ìƒê³¡', 'ì–´ì–‘', 'ìš°ë¶í‰', 'ìš”ì„œ',
            'í˜„í† ', 'ë‚™ë‘', 'ëŒ€ë°©', 'ì„ë‘”', 'ì§„ë²ˆ', 'ë™í•´', 'í‰ì›', 'ì œë¶',
            'ì œë‚¨', 'ë™í‰', 'ì„ì¹˜', 'ë¶í•´', 'ë™ë˜', 'ì„±ì–‘', 'ì‚°ì–‘', 'ì„íšŒ',
            'ë™êµ°', 'ì§„ë¥˜', 'ì–‘êµ­', 'íŒ¨êµ­', 'ì‚¬ìˆ˜', 'í•˜ë¹„', 'ê´‘ë¦‰', 'í•˜ë¹„',
            'ë‹¨ì–‘', 'ì˜¤êµ°', 'íšŒê³„', 'ì—¬ê°•', 'êµ¬ê°•', 'ì‹œìƒ', 'ì¥ì‚¬', 'ê³„ì–‘',
            'ì˜ë¦‰', 'ë¬´ë¦‰', 'ì˜ì²œ', 'ë‚¨ì–‘', 'ì—¬ë‚¨', 'ê°•í•˜', 'ë‚¨êµ°', 'ë¬´ë¦‰',
            'ì¥ì‚¬', 'ê³„ì–‘', 'ì˜ë¦‰', 'ë¬´ë¦‰', 'ì˜ì²œ', 'ë‚¨ì–‘', 'ì—¬ë‚¨', 'ê°•í•˜',
            'ë‚¨êµ°', 'ë¬´ë¦‰', 'ì¥ì‚¬', 'ê³„ì–‘', 'ì˜ë¦‰', 'ë¬´ë¦‰', 'ì˜ì²œ', 'ë‚¨ì–‘',
            'ì—¬ë‚¨', 'ê°•í•˜', 'ë‚¨êµ°', 'ë¬´ë¦‰', 'ì¥ì‚¬', 'ê³„ì–‘', 'ì˜ë¦‰', 'ë¬´ë¦‰',
            'ì˜ì²œ', 'ë‚¨ì–‘', 'ì—¬ë‚¨', 'ê°•í•˜', 'ë‚¨êµ°', 'ë¬´ë¦‰', 'ì¥ì‚¬', 'ê³„ì–‘',
            'ì˜ë¦‰', 'ë¬´ë¦‰', 'ì˜ì²œ', 'ë‚¨ì–‘', 'ì—¬ë‚¨', 'ê°•í•˜', 'ë‚¨êµ°', 'ë¬´ë¦‰'
        ];

        // ì´ë²¤íŠ¸ ëª©ë¡
        const gameEvents = [
            {
                title: "í’ë…„ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤",
                description: "ì˜¬í•´ ë†ì‚¬ê°€ ëŒ€í’ì‘ì„ ì´ë£¨ì–´ ë°±ì„±ë“¤ì´ ê¸°ë»í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
                effects: { economy: 15, culture: 5 },
                probability: 0.15
            },
            {
                title: "ì „ì—¼ë³‘ì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤",
                description: "ì—­ë³‘ì´ ëŒì•„ ë§ì€ ë°±ì„±ë“¤ì´ ê³ í†µë°›ê³  ìˆìŠµë‹ˆë‹¤.",
                effects: { military: -10, economy: -15, culture: -5 },
                probability: 0.1
            },
            {
                title: "ëª…ì¥ì´ ë“±ìš©ë˜ì—ˆìŠµë‹ˆë‹¤",
                description: "ë›°ì–´ë‚œ ë¬´ì¥ì´ ì§„ì˜ì— í•©ë¥˜í•˜ì—¬ êµ°ì‚¬ë ¥ì´ í¬ê²Œ í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤.",
                effects: { military: 20, culture: 5 },
                probability: 0.12
            },
            {
                title: "ìƒì¸ë“¤ì´ ë²ˆì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤",
                description: "ë¬´ì—­ì´ í™œë°œí•´ì ¸ ê²½ì œê°€ í¬ê²Œ ë°œì „í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
                effects: { economy: 18, culture: 8 },
                probability: 0.13
            },
            {
                title: "í•™ìë“¤ì´ ëª¨ì—¬ë“¤ì—ˆìŠµë‹ˆë‹¤",
                description: "ìœ ëª…í•œ í•™ìë“¤ì´ ì§„ì˜ì— í•©ë¥˜í•˜ì—¬ ë¬¸í™”ê°€ ë°œë‹¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
                effects: { culture: 20, economy: 5 },
                probability: 0.11
            },
            {
                title: "ìì—°ì¬í•´ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",
                description: "í™ìˆ˜ì™€ ê°€ë­„ìœ¼ë¡œ ì¸í•´ í° í”¼í•´ë¥¼ ì…ì—ˆìŠµë‹ˆë‹¤.",
                effects: { economy: -12, military: -8 },
                probability: 0.08
            },
            {
                title: "ë°˜ë€ì´ ì¼ì–´ë‚¬ìŠµë‹ˆë‹¤",
                description: "ì¼ë¶€ ì§€ì—­ì—ì„œ ë°˜ë€ì´ ë°œìƒí•˜ì—¬ ì§„ì••ì— ë‚˜ì„œì•¼ í•©ë‹ˆë‹¤.",
                effects: { military: -15, culture: -10 },
                probability: 0.07
            },
            {
                title: "ìƒˆë¡œìš´ ê¸°ìˆ ì´ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤",
                description: "ë†ì—…ê³¼ êµ°ì‚¬ ê¸°ìˆ ì˜ ë°œì „ìœ¼ë¡œ êµ­ë ¥ì´ í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤.",
                effects: { military: 10, economy: 12, culture: 8 },
                probability: 0.09
            },
            {
                title: "ì™¸êµ ì„±ê³µ",
                description: "ì£¼ë³€ ì„¸ë ¥ê³¼ì˜ ì™¸êµê°€ ì„±ê³µí•˜ì—¬ í‰í™”ë¡œìš´ ì‹œê¸°ë¥¼ ë§ì•˜ìŠµë‹ˆë‹¤.",
                effects: { economy: 10, culture: 15 },
                probability: 0.1
            },
            {
                title: "êµ°ì‚¬ í›ˆë ¨ ê°•í™”",
                description: "ì²´ê³„ì ì¸ êµ°ì‚¬ í›ˆë ¨ìœ¼ë¡œ ë³‘ì‚¬ë“¤ì˜ ì‹¤ë ¥ì´ í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤.",
                effects: { military: 12, culture: 3 },
                probability: 0.12
            }
        ];

        let gameState = {
            selectedFaction: null,
            turn: 1,
            territories: {},
            gameStarted: false,
            stats: {
                wei: { military: 70, economy: 80, culture: 75 },
                shu: { military: 75, economy: 70, culture: 85 },
                wu: { military: 80, economy: 85, culture: 70 }
            },
            recentEvents: []
        };

        // ê²Œì„ ì´ˆê¸°í™”
        function initializeGame() {
            const map = document.getElementById('gameMap');
            map.innerHTML = '';
            
            // 144ê°œ ì¹¸ ìƒì„± (12x12)
            for (let i = 0; i < 144; i++) {
                const territory = document.createElement('div');
                territory.className = 'territory neutral';
                territory.textContent = territories[i];
                territory.dataset.index = i;
                territory.onclick = () => captureTerritory(i);
                map.appendChild(territory);
                
                // ì´ˆê¸° ì§„ì˜ ë°°ì¹˜ (ê°ê° 48ê°œì”©)
                if (i < 48) {
                    gameState.territories[i] = 'wei';
                    territory.className = 'territory wei';
                } else if (i < 96) {
                    gameState.territories[i] = 'shu';
                    territory.className = 'territory shu';
                } else {
                    gameState.territories[i] = 'wu';
                    territory.className = 'territory wu';
                }
            }
            
            updateUI();
            updateStatsDisplay();
        }

        // ì§„ì˜ ì„ íƒ
        function selectFaction(faction) {
            gameState.selectedFaction = faction;
            gameState.gameStarted = true;
            
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.faction-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`.faction-btn.${faction}`).classList.add('selected');
            
            updateCapturableAreas();
            updateStatusMessage(`${getFactionName(faction)} ì§„ì˜ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤! ì „ëµì ìœ¼ë¡œ ì˜í† ë¥¼ í™•ì¥í•˜ì„¸ìš”.`);
        }

        // ì˜í†  ì ë ¹ (ëŠ¥ë ¥ì¹˜ ê¸°ë°˜)
        function captureTerritory(index) {
            if (!gameState.selectedFaction || !gameState.gameStarted) {
                updateStatusMessage('ë¨¼ì € ì§„ì˜ì„ ì„ íƒí•˜ì„¸ìš”!');
                return;
            }

            const territory = document.querySelector(`[data-index="${index}"]`);
            if (!territory.classList.contains('capturable')) {
                updateStatusMessage('ì¸ì ‘í•œ ë•…ë§Œ ì ë ¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!');
                return;
            }

            const currentOwner = gameState.territories[index];
            const playerStats = gameState.stats[gameState.selectedFaction];
            const enemyStats = gameState.stats[currentOwner];
            
            // ì „íˆ¬ë ¥ ê³„ì‚° (êµ°ì‚¬ë ¥ + ê²½ì œë ¥*0.3 + ë¬¸í™”ë ¥*0.2)
            const playerPower = playerStats.military + playerStats.economy * 0.3 + playerStats.culture * 0.2;
            const enemyPower = enemyStats.military + enemyStats.economy * 0.3 + enemyStats.culture * 0.2;
            
            // ìŠ¹ë¦¬ í™•ë¥  ê³„ì‚°
            const winChance = playerPower / (playerPower + enemyPower);
            const randomValue = Math.random();
            
            if (randomValue < winChance) {
                // ìŠ¹ë¦¬
                gameState.territories[index] = gameState.selectedFaction;
                territory.className = `territory ${gameState.selectedFaction}`;
                updateStatusMessage(`${territories[index]}ì„(ë¥¼) ì„±ê³µì ìœ¼ë¡œ ì ë ¹í–ˆìŠµë‹ˆë‹¤!`);
                
                // ìŠ¹ë¦¬ ë³´ìƒ
                gameState.stats[gameState.selectedFaction].military += 2;
                gameState.stats[gameState.selectedFaction].economy += 1;
            } else {
                // íŒ¨ë°°
                updateStatusMessage(`${territories[index]} ì ë ¹ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì˜ ì €í•­ì´ ê°•í•©ë‹ˆë‹¤.`);
                
                // íŒ¨ë°° í˜ë„í‹°
                gameState.stats[gameState.selectedFaction].military -= 3;
            }
            
            updateUI();
            updateStatsDisplay();
            
            // ë‹¤ìŒ í„´ìœ¼ë¡œ
            setTimeout(() => {
                nextTurn();
            }, 1500);
        }

        // ë‹¤ìŒ í„´
        function nextTurn() {
            if (!gameState.gameStarted) return;
            
            gameState.turn++;
            
            // ì´ë²¤íŠ¸ ë°œìƒ (30% í™•ë¥ )
            if (Math.random() < 0.3) {
                triggerRandomEvent();
            }
            
            // AI í„´
            aiTurn();
            
            // ëŠ¥ë ¥ì¹˜ ìì—° íšŒë³µ/ê°ì†Œ
            Object.keys(gameState.stats).forEach(faction => {
                const stats = gameState.stats[faction];
                const territoryCount = Object.values(gameState.territories).filter(t => t === faction).length;
                
                // ì˜í†  ìˆ˜ì— ë”°ë¥¸ ë³´ë„ˆìŠ¤/í˜ë„í‹°
                const territoryBonus = Math.floor(territoryCount / 20);
                stats.economy += territoryBonus;
                stats.culture += Math.floor(territoryBonus / 2);
                
                // ëŠ¥ë ¥ì¹˜ ìƒí•œ/í•˜í•œ ì ìš©
                stats.military = Math.max(10, Math.min(100, stats.military));
                stats.economy = Math.max(10, Math.min(100, stats.economy));
                stats.culture = Math.max(10, Math.min(100, stats.culture));
            });
            
            updateCapturableAreas();
            updateStatsDisplay();
            checkGameEnd();
        }

        // ëœë¤ ì´ë²¤íŠ¸ ë°œìƒ
        function triggerRandomEvent() {
            const availableEvents = gameEvents.filter(event => Math.random() < event.probability);
            if (availableEvents.length === 0) return;
            
            const event = availableEvents[Math.floor(Math.random() * availableEvents.length)];
            const affectedFaction = ['wei', 'shu', 'wu'][Math.floor(Math.random() * 3)];
            
            // ì´ë²¤íŠ¸ íš¨ê³¼ ì ìš©
            Object.keys(event.effects).forEach(stat => {
                gameState.stats[affectedFaction][stat] += event.effects[stat];
                gameState.stats[affectedFaction][stat] = Math.max(10, Math.min(100, gameState.stats[affectedFaction][stat]));
            });
            
            // ì´ë²¤íŠ¸ ê¸°ë¡
            const eventRecord = {
                ...event,
                faction: affectedFaction,
                turn: gameState.turn
            };
            
            gameState.recentEvents.unshift(eventRecord);
            if (gameState.recentEvents.length > 5) {
                gameState.recentEvents.pop();
            }
            
            updateEventsDisplay();
            updateStatusMessage(`${getFactionName(affectedFaction)}ì— "${event.title}" ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤!`);
        }

        // AI í„´
        function aiTurn() {
            const factions = ['wei', 'shu', 'wu'].filter(f => f !== gameState.selectedFaction);
            
            factions.forEach((faction, index) => {
                setTimeout(() => {
                    const capturableAreas = getCapturableAreasForFaction(faction);
                    if (capturableAreas.length > 0) {
                        // AIëŠ” ê°€ì¥ ì•½í•œ ì ì„ ìš°ì„  ê³µê²©
                        const bestTarget = capturableAreas.reduce((best, current) => {
                            const currentOwner = gameState.territories[current];
                            const bestOwner = gameState.territories[best];
                            
                            if (!currentOwner) return current;
                            if (!bestOwner) return best;
                            
                            const currentPower = getTotalPower(currentOwner);
                            const bestPower = getTotalPower(bestOwner);
                            
                            return currentPower < bestPower ? current : best;
                        });
                        
                        // AI ì „íˆ¬ ê³„ì‚°
                        const aiStats = gameState.stats[faction];
                        const targetOwner = gameState.territories[bestTarget];
                        const enemyStats = gameState.stats[targetOwner];
                        
                        const aiPower = getTotalPower(faction);
                        const enemyPower = getTotalPower(targetOwner);
                        
                        const winChance = aiPower / (aiPower + enemyPower);
                        
                        if (Math.random() < winChance) {
                            gameState.territories[bestTarget] = faction;
                            const territory = document.querySelector(`[data-index="${bestTarget}"]`);
                            territory.className = `territory ${faction}`;
                            
                            // AI ìŠ¹ë¦¬ ë³´ìƒ
                            gameState.stats[faction].military += 1;
                        } else {
                            // AI íŒ¨ë°° í˜ë„í‹°
                            gameState.stats[faction].military -= 2;
                        }
                    }
                    
                    if (index === factions.length - 1) {
                        updateUI();
                        updateStatsDisplay();
                    }
                }, (index + 1) * 500);
            });
        }

        // ì´ ì „íˆ¬ë ¥ ê³„ì‚°
        function getTotalPower(faction) {
            const stats = gameState.stats[faction];
            return stats.military + stats.economy * 0.3 + stats.culture * 0.2;
        }

        // ì ë ¹ ê°€ëŠ¥í•œ ì§€ì—­ í‘œì‹œ
        function updateCapturableAreas() {
            if (!gameState.selectedFaction) return;
            
            // ëª¨ë“  capturable í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.territory').forEach(t => {
                t.classList.remove('capturable');
            });
            
            // ì„ íƒëœ ì§„ì˜ì´ ì ë ¹ ê°€ëŠ¥í•œ ì§€ì—­ í‘œì‹œ
            const capturableAreas = getCapturableAreasForFaction(gameState.selectedFaction);
            capturableAreas.forEach(index => {
                const territory = document.querySelector(`[data-index="${index}"]`);
                territory.classList.add('capturable');
            });
        }

        // íŠ¹ì • ì§„ì˜ì´ ì ë ¹ ê°€ëŠ¥í•œ ì§€ì—­ ì°¾ê¸°
        function getCapturableAreasForFaction(faction) {
            const capturableAreas = [];
            
            for (let i = 0; i < 144; i++) {
                if (gameState.territories[i] === faction) continue;
                
                // ì¸ì ‘í•œ ì¹¸ í™•ì¸
                const adjacentIndices = getAdjacentIndices(i);
                const hasAdjacentTerritory = adjacentIndices.some(adjIndex => 
                    gameState.territories[adjIndex] === faction
                );
                
                if (hasAdjacentTerritory) {
                    capturableAreas.push(i);
                }
            }
            
            return capturableAreas;
        }

        // ì¸ì ‘í•œ ì¹¸ì˜ ì¸ë±ìŠ¤ êµ¬í•˜ê¸°
        function getAdjacentIndices(index) {
            const row = Math.floor(index / 12);
            const col = index % 12;
            const adjacent = [];
            
            // ìƒí•˜ì¢Œìš° í™•ì¸
            if (row > 0) adjacent.push(index - 12); // ìœ„
            if (row < 11) adjacent.push(index + 12); // ì•„ë˜
            if (col > 0) adjacent.push(index - 1); // ì™¼ìª½
            if (col < 11) adjacent.push(index + 1); // ì˜¤ë¥¸ìª½
            
            return adjacent;
        }

        // ëŠ¥ë ¥ì¹˜ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateStatsDisplay() {
            const statsContainer = document.getElementById('factionStats');
            statsContainer.innerHTML = '';
            
            Object.keys(gameState.stats).forEach(faction => {
                const stats = gameState.stats[faction];
                const factionDiv = document.createElement('div');
                factionDiv.style.marginBottom = '20px';
                factionDiv.style.padding = '15px';
                factionDiv.style.background = 'rgba(255,255,255,0.05)';
                factionDiv.style.borderRadius = '8px';
                factionDiv.style.border = gameState.selectedFaction === faction ? '2px solid #ffd700' : '1px solid rgba(255,255,255,0.2)';
                
                factionDiv.innerHTML = `
                    <h4 style="color: #ffd700; margin-bottom: 10px; text-align: center;">${getFactionName(faction)}</h4>
                    <div class="stat-item">
                        <div class="stat-name">âš”ï¸ êµ°ì‚¬ë ¥</div>
                        <div class="stat-value">${stats.military}</div>
                        <div class="stat-bar">
                            <div class="stat-fill military" style="width: ${stats.military}%"></div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">ğŸ’° ê²½ì œë ¥</div>
                        <div class="stat-value">${stats.economy}</div>
                        <div class="stat-bar">
                            <div class="stat-fill economy" style="width: ${stats.economy}%"></div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">ğŸ“š ë¬¸í™”ë ¥</div>
                        <div class="stat-value">${stats.culture}</div>
                        <div class="stat-bar">
                            <div class="stat-fill culture" style="width: ${stats.culture}%"></div>
                        </div>
                    </div>
                `;
                
                statsContainer.appendChild(factionDiv);
            });
        }

        // ì´ë²¤íŠ¸ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateEventsDisplay() {
            const eventsContainer = document.getElementById('eventsList');
            eventsContainer.innerHTML = '';
            
            if (gameState.recentEvents.length === 0) {
                eventsContainer.innerHTML = '<p style="text-align: center; color: #888;">ì•„ì§ ë°œìƒí•œ ì‚¬ê±´ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            gameState.recentEvents.forEach(event => {
                const eventDiv = document.createElement('div');
                eventDiv.className = 'event-item';
                
                const effectsHtml = Object.keys(event.effects).map(stat => {
                    const value = event.effects[stat];
                    const isPositive = value > 0;
                    const statName = stat === 'military' ? 'âš”ï¸' : stat === 'economy' ? 'ğŸ’°' : 'ğŸ“š';
                    return `<span class="effect ${isPositive ? 'positive' : 'negative'}">${statName}${isPositive ? '+' : ''}${value}</span>`;
                }).join('');
                
                eventDiv.innerHTML = `
                    <div class="event-title">${event.title}</div>
                    <div class="event-description">${event.description}</div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div class="event-effects">${effectsHtml}</div>
                        <small style="color: #888;">${getFactionName(event.faction)} - ${event.turn}í„´</small>
                    </div>
                `;
                
                eventsContainer.appendChild(eventDiv);
            });
        }

        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            const counts = { wei: 0, shu: 0, wu: 0 };
            
            Object.values(gameState.territories).forEach(faction => {
                counts[faction]++;
            });
            
            document.getElementById('wei-count').textContent = counts.wei;
            document.getElementById('shu-count').textContent = counts.shu;
            document.getElementById('wu-count').textContent = counts.wu;
        }

        // ê²Œì„ ì¢…ë£Œ í™•ì¸
        function checkGameEnd() {
            const counts = { wei: 0, shu: 0, wu: 0 };
            Object.values(gameState.territories).forEach(faction => {
                counts[faction]++;
            });
            
            const totalTerritories = Object.keys(gameState.territories).length;
            const winThreshold = Math.floor(totalTerritories * 0.6); // 60% ì´ìƒ ì ë ¹ì‹œ ìŠ¹ë¦¬
            
            for (const [faction, count] of Object.entries(counts)) {
                if (count >= winThreshold) {
                    updateStatusMessage(`ğŸ‰ ${getFactionName(faction)} ì§„ì˜ì´ ì²œí•˜ë¥¼ í†µì¼í–ˆìŠµë‹ˆë‹¤! ğŸ‰`);
                    gameState.gameStarted = false;
                    return;
                }
            }
            
            // 50í„´ ì´í›„ì—ëŠ” ëŠ¥ë ¥ì¹˜ í•©ê³„ë¡œ ìŠ¹ë¶€ ê²°ì •
            if (gameState.turn >= 50) {
                const powerRanking = Object.keys(gameState.stats).map(faction => ({
                    faction,
                    power: getTotalPower(faction),
                    territories: counts[faction]
                })).sort((a, b) => (b.power + b.territories * 2) - (a.power + a.territories * 2));
                
                const winner = powerRanking[0];
                updateStatusMessage(`ğŸ‰ ${getFactionName(winner.faction)} ì§„ì˜ì´ ìµœê°•ì˜ ì„¸ë ¥ìœ¼ë¡œ ìŠ¹ë¦¬í–ˆìŠµë‹ˆë‹¤! ğŸ‰`);
                gameState.gameStarted = false;
            }
        }

        // ì§„ì˜ ì´ë¦„ ë°˜í™˜
        function getFactionName(faction) {
            const names = { wei: 'ìœ„(é­)', shu: 'ì´‰(èœ€)', wu: 'ì˜¤(å³)' };
            return names[faction];
        }

        // ìƒíƒœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
        function updateStatusMessage(message) {
            document.getElementById('statusMessage').textContent = message;
        }

        // ê²Œì„ ë¦¬ì…‹
        function resetGame() {
            gameState = {
                selectedFaction: null,
                turn: 1,
                territories: {},
                gameStarted: false,
                stats: {
                    wei: { military: 70, economy: 80, culture: 75 },
                    shu: { military: 75, economy: 70, culture: 85 },
                    wu: { military: 80, economy: 85, culture: 70 }
                },
                recentEvents: []
            };
            
            document.querySelectorAll('.faction-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            initializeGame();
            updateEventsDisplay();
            updateStatusMessage('ì§„ì˜ì„ ì„ íƒí•˜ê³  ì „ëµì ìœ¼ë¡œ ì²œí•˜í†µì¼ì„ ì´ë£¨ì–´ë³´ì„¸ìš”!');
        }

        // ìë™ ì§„í–‰
        function autoPlay() {
            if (!gameState.gameStarted) {
                updateStatusMessage('ë¨¼ì € ì§„ì˜ì„ ì„ íƒí•˜ì„¸ìš”!');
                return;
            }
            
            const interval = setInterval(() => {
                if (!gameState.gameStarted) {
                    clearInterval(interval);
                    return;
                }
                
                nextTurn();
            }, 2000);
        }

        // ê²Œì„ ì‹œì‘
        initializeGame();
        updateEventsDisplay();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'983fc9e0a4e70d05',t:'MTc1ODY5MDc2NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
