<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏÇºÍµ≠ÏßÄ ÎïÖÎî∞Î®πÍ∏∞ - Ï†ÑÎûµ ÏãúÎÆ¨Î†àÏù¥ÏÖò</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', Arial, sans-serif;
            background: linear-gradient(135deg, #2c1810 0%, #8b4513 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }

        .game-container {
            max-width: 1400px;
            margin: 0 auto;
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 20px;
            align-items: start;
        }

        .left-panel, .right-panel {
            background: rgba(0,0,0,0.4);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #8b4513;
        }

        .center-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .faction-selector {
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            border: 2px solid #8b4513;
        }

        .faction-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .faction-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .faction-btn.wei {
            background: linear-gradient(45deg, #4169e1, #6495ed);
            color: white;
        }

        .faction-btn.shu {
            background: linear-gradient(45deg, #dc143c, #ff6b6b);
            color: white;
        }

        .faction-btn.wu {
            background: linear-gradient(45deg, #228b22, #90ee90);
            color: white;
        }

        .faction-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .faction-btn.selected {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255,215,0,0.5);
        }

        .stats-panel {
            margin-bottom: 20px;
        }

        .stats-panel h3 {
            margin-bottom: 15px;
            color: #ffd700;
            text-align: center;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }

        .stat-name {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-value {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .stat-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
		}
		
		.play-bangbeob {
			display: flex;
			width: 100%;
			top: 10px;
			padding: 5px;
			background: rgba(255,255,255,0.1);
			border-radius: 5px;
		}
		
		
        .stat-fill {
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }
		
		

        .military { background: linear-gradient(90deg, #dc143c, #ff6b6b); }
        .economy { background: linear-gradient(90deg, #ffd700, #ffed4e); }
        .culture { background: linear-gradient(90deg, #9370db, #dda0dd); }

        .events-panel h3 {
            margin-bottom: 15px;
            color: #ffd700;
            text-align: center;
        }

        .event-item {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #ffd700;
        }

        .event-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #ffd700;
        }

        .event-description {
            font-size: 0.9rem;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .event-effects {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .effect {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .effect.positive { background: rgba(34, 197, 94, 0.3); color: #22c55e; }
        .effect.negative { background: rgba(239, 68, 68, 0.3); color: #ef4444; }

        .map-container {
            background: rgba(0,0,0,0.4);
            padding: 20px;
            border-radius: 15px;
            border: 3px solid #8b4513;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .game-map {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 2px;
            background: #2c1810;
            padding: 10px;
            border-radius: 10px;
        }

        .territory {
            width: 45px;
            height: 45px;
            border: 1px solid #8b4513;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
        }

        .territory:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 0 15px rgba(255,215,0,0.8);
        }

        .territory.wei {
            background: linear-gradient(135deg, #4169e1, #1e3a8a);
            color: white;
        }

        .territory.shu {
            background: linear-gradient(135deg, #dc143c, #991b1b);
            color: white;
        }

        .territory.wu {
            background: linear-gradient(135deg, #228b22, #166534);
            color: white;
        }

        .territory.neutral {
            background: linear-gradient(135deg, #6b7280, #374151);
            color: #d1d5db;
        }

        .territory.capturable {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 5px rgba(255,215,0,0.5); }
            50% { box-shadow: 0 0 20px rgba(255,215,0,1); }
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(45deg, #8b4513, #a0522d);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: linear-gradient(45deg, #a0522d, #cd853f);
            transform: translateY(-2px);
        }

        .status-message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.3);
        }

        .territory-info h3 {
            margin-bottom: 15px;
            color: #ffd700;
            text-align: center;
        }

        .territory-count {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }

        .faction-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            border: 1px solid #fff;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .territory {
                width: 35px;
                height: 35px;
                font-size: 0.6rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>üèõÔ∏è ÏÇºÍµ≠ÏßÄ Ï†ÑÎûµ ÏãúÎÆ¨Î†àÏù¥ÏÖò üèõÔ∏è</h1>
        
        <div class="faction-selector">
            <h3 style="margin-bottom: 15px;">ÏßÑÏòÅÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</h3>
            <div class="faction-buttons">
                <button class="faction-btn wei" onclick="selectFaction('wei')">ÏúÑ(È≠è) Ï°∞Ï°∞</button>
                <button class="faction-btn shu" onclick="selectFaction('shu')">Ï¥â(ËúÄ) Ïú†ÎπÑ</button>
                <button class="faction-btn wu" onclick="selectFaction('wu')">Ïò§(Âê≥) ÏÜêÍ∂å</button>
            </div>
        </div>

        <div class="main-content">
            <div class="left-panel">
                <div class="stats-panel">
                    <h3>üìä ÏßÑÏòÅÎ≥Ñ Îä•Î†•Ïπò</h3>
                    <div id="factionStats"></div>
                </div>
                
                <div class="territory-info">
                    <h3>üó∫Ô∏è ÏòÅÌÜ† ÌòÑÌô©</h3>
                    <div class="territory-count">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div class="faction-color" style="background: linear-gradient(45deg, #4169e1, #1e3a8a);"></div>
                            <span>ÏúÑ</span>
                        </div>
                        <span id="wei-count">48</span>
                    </div>
                    <div class="territory-count">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div class="faction-color" style="background: linear-gradient(45deg, #dc143c, #991b1b);"></div>
                            <span>Ï¥â</span>
                        </div>
                        <span id="shu-count">48</span>
                    </div>
                    <div class="territory-count">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div class="faction-color" style="background: linear-gradient(45deg, #228b22, #166534);"></div>
                            <span>Ïò§</span>
                        </div>
                        <span id="wu-count">48</span>
                    </div>
                </div>
            </div>

            <div class="center-panel">
				<div class="status-message" id="statusMessage">
                    ÏßÑÏòÅÏùÑ ÏÑ†ÌÉùÌïòÍ≥† Ï†ÑÎûµÏùÑ ÏÑ∏ÏõåÎ≥¥ÏÑ∏Ïöî!
                </div>
				
                <div class="map-container">
                    <div class="game-map" id="gameMap"></div>
                </div>
                
                <div class="controls">
                    <button class="control-btn" onclick="resetGame()">Í≤åÏûÑ Ï¥àÍ∏∞Ìôî</button>
                    <button class="control-btn" onclick="nextTurn()">Îã§Ïùå ÌÑ¥</button>
                    <button class="control-btn" onclick="autoPlay()">ÏûêÎèô ÏßÑÌñâ</button>
                </div>

                
            </div>
			
			<div class="play-bangbeob">
				<h3>ÌïòÎäîÎ≤ï</h3>
				ÏµúÏÉÅÎã®Ïùò ÌååÎûë, Îπ®Í∞ï, Ï¥àÎ°ùÏùò ÏÑ∏ Î≤ÑÌäº Ï§ë ÌïòÎÇòÎ•º ÌÅ¥Î¶≠Ìï¥ ÌåÄÏùÑ ÏÑ†ÌÉùÌï©ÎãàÎã§.<br>
				ÌåÄ ÏÑ†ÌÉù Î≤ÑÌäº Î∞ëÏóê ÏûàÎäî Í≤ÉÏù¥ ÎßµÏûÖÎãàÎã§.<br>
				ÏÑ†ÌÉùÌïú ÌåÄÏùò ÏÉâÍπîÏùò ÎïÖÏù¥ ÏßÄÍ∏à Í∞ÄÏßÄÍ≥† ÏûàÎäî ÎïÖÏù¥Î©∞,<br>ÎÖ∏ÎûÄÏÉâÏúºÎ°ú ÏùÄÏùÄÌïòÍ≤å ÎπõÎÇòÎäî ÎïÖÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥ Í∑∏ Í≥≥ÏùÑ Í≥µÍ≤©Ìï©ÎãàÎã§.<br>
				Íµ∞ÏÇ¨Î†•Ïóê Îî∞ÎùºÏÑú ÎûúÎç§ÏúºÎ°ú Í≥µÍ≤©Ïùò ÏÑ±Ìå®Í∞Ä Í∞àÎ¶ΩÎãàÎã§. 60% Ïù¥ÏÉÅÏùò ÎïÖÏùÑ Î®πÏúºÎ©¥ ÏäπÎ¶¨!
			</div>
			
            <div class="right-panel">
                <div class="events-panel">
                    <h3>üìú ÏµúÍ∑º ÏÇ¨Í±¥</h3>
                    <div id="eventsList"></div>
                </div>
            </div>
			
        </div>
    </div>

    <script>
        // Ïã§Ï†ú ÌïúÎÇòÎùº ÏßÄÎ™Ö 144Í∞ú
        const territories = [
            'ÎÇôÏñë', 'Ïû•Ïïà', 'ÏóÖÏÑ±', 'ÏôÑÏÑ±', 'ÌóàÏ∞Ω', 'ÏßÑÎ•ò', 'Í∞úÎ¥â', 'Ï†ïÏ£º',
            'ÏñëÏ£º', 'ÏÑúÏ£º', 'Ïó∞Ï£º', 'Í∏∞Ï£º', 'Ï≤≠Ï£º', 'Ïú†Ï£º', 'Î≥ëÏ£º', 'ÏòπÏ£º',
            'ÏñëÏñë', 'Í∞ïÎ¶â', 'Î¨¥Ï∞Ω', 'Í±¥ÏóÖ', 'ÌöåÍ≥Ñ', 'Ïò§Íµ∞', 'Îã®Ïñë', 'Ïó¨ÎÇ®',
            'Ïó¨Í∞ï', 'Íµ¨Í∞ï', 'ÏãúÏÉÅ', 'Ïû•ÏÇ¨', 'Í≥ÑÏñë', 'ÏòÅÎ¶â', 'Î¨¥Î¶â', 'ÏòÅÏ≤ú',
            'ÏÑ±ÎèÑ', 'ÌïúÏ§ë', 'ÌååÍµ∞', 'Í¥ëÌïú', 'Ï¥âÍµ∞', 'Í±¥ÏúÑ', 'ÏõîÏàò', 'ÏòÅÏ∞Ω',
            'Í±¥ÎÖï', 'Ïö¥ÎÇ®', 'ÏùµÏ£º', 'ÎüâÏ£º', 'Î¨¥ÎèÑ', 'ÏùåÌèâ', 'Ï≤úÏàò', 'ÏÑúÌèâ',
            'ÏïàÏ†ï', 'Î∂ÅÏßÄ', 'ÏÉÅÍµ∞', 'ÌíçÏùµ', 'Î∂ÄÌíç', 'Í≤ΩÏ°∞', 'Ï¢åÌíçÏùµ', 'Ïö∞Î∂ÄÌíç',
            'ÌïòÎèô', 'ÌïòÎÇ¥', 'ÏÉÅÎãπ', 'ÌÉúÏõê', 'ÏÉÅÍ≥°', 'Ïñ¥Ïñë', 'Ïö∞Î∂ÅÌèâ', 'ÏöîÏÑú',
            'ÌòÑÌÜ†', 'ÎÇôÎûë', 'ÎåÄÎ∞©', 'ÏûÑÎëî', 'ÏßÑÎ≤à', 'ÎèôÌï¥', 'ÌèâÏõê', 'Ï†úÎ∂Å',
            'Ï†úÎÇ®', 'ÎèôÌèâ', 'ÏûÑÏπò', 'Î∂ÅÌï¥', 'ÎèôÎûò', 'ÏÑ±Ïñë', 'ÏÇ∞Ïñë', 'ÏûÑÌöå',
            'ÎèôÍµ∞', 'ÏßÑÎ•ò', 'ÏñëÍµ≠', 'Ìå®Íµ≠', 'ÏÇ¨Ïàò', 'ÌïòÎπÑ', 'Í¥ëÎ¶â', 'ÌïòÎπÑ',
            'Îã®Ïñë', 'Ïò§Íµ∞', 'ÌöåÍ≥Ñ', 'Ïó¨Í∞ï', 'Íµ¨Í∞ï', 'ÏãúÏÉÅ', 'Ïû•ÏÇ¨', 'Í≥ÑÏñë',
            'ÏòÅÎ¶â', 'Î¨¥Î¶â', 'ÏòÅÏ≤ú', 'ÎÇ®Ïñë', 'Ïó¨ÎÇ®', 'Í∞ïÌïò', 'ÎÇ®Íµ∞', 'Î¨¥Î¶â',
            'Ïû•ÏÇ¨', 'Í≥ÑÏñë', 'ÏòÅÎ¶â', 'Î¨¥Î¶â', 'ÏòÅÏ≤ú', 'ÎÇ®Ïñë', 'Ïó¨ÎÇ®', 'Í∞ïÌïò',
            'ÎÇ®Íµ∞', 'Î¨¥Î¶â', 'Ïû•ÏÇ¨', 'Í≥ÑÏñë', 'ÏòÅÎ¶â', 'Î¨¥Î¶â', 'ÏòÅÏ≤ú', 'ÎÇ®Ïñë',
            'Ïó¨ÎÇ®', 'Í∞ïÌïò', 'ÎÇ®Íµ∞', 'Î¨¥Î¶â', 'Ïû•ÏÇ¨', 'Í≥ÑÏñë', 'ÏòÅÎ¶â', 'Î¨¥Î¶â',
            'ÏòÅÏ≤ú', 'ÎÇ®Ïñë', 'Ïó¨ÎÇ®', 'Í∞ïÌïò', 'ÎÇ®Íµ∞', 'Î¨¥Î¶â', 'Ïû•ÏÇ¨', 'Í≥ÑÏñë',
            'ÏòÅÎ¶â', 'Î¨¥Î¶â', 'ÏòÅÏ≤ú', 'ÎÇ®Ïñë', 'Ïó¨ÎÇ®', 'Í∞ïÌïò', 'ÎÇ®Íµ∞', 'Î¨¥Î¶â'
        ];

        // Ïù¥Î≤§Ìä∏ Î™©Î°ù
        const gameEvents = [
            {
                title: "ÌíçÎÖÑÏù¥ Îì§ÏóàÏäµÎãàÎã§",
                description: "Ïò¨Ìï¥ ÎÜçÏÇ¨Í∞Ä ÎåÄÌíçÏûëÏùÑ Ïù¥Î£®Ïñ¥ Î∞±ÏÑ±Îì§Ïù¥ Í∏∞ÎªêÌïòÍ≥† ÏûàÏäµÎãàÎã§.",
                effects: { economy: 15, culture: 5 },
                probability: 0.15
            },
            {
                title: "Ï†ÑÏóºÎ≥ëÏù¥ Î∞úÏÉùÌñàÏäµÎãàÎã§",
                description: "Ïó≠Î≥ëÏù¥ ÎèåÏïÑ ÎßéÏùÄ Î∞±ÏÑ±Îì§Ïù¥ Í≥†ÌÜµÎ∞õÍ≥† ÏûàÏäµÎãàÎã§.",
                effects: { military: -10, economy: -15, culture: -5 },
                probability: 0.1
            },
            {
                title: "Î™ÖÏû•Ïù¥ Îì±Ïö©ÎêòÏóàÏäµÎãàÎã§",
                description: "Îõ∞Ïñ¥ÎÇú Î¨¥Ïû•Ïù¥ ÏßÑÏòÅÏóê Ìï©Î•òÌïòÏó¨ Íµ∞ÏÇ¨Î†•Ïù¥ ÌÅ¨Í≤å Ìñ•ÏÉÅÎêòÏóàÏäµÎãàÎã§.",
                effects: { military: 20, culture: 5 },
                probability: 0.12
            },
            {
                title: "ÏÉÅÏù∏Îì§Ïù¥ Î≤àÏÑ±ÌïòÍ≥† ÏûàÏäµÎãàÎã§",
                description: "Î¨¥Ïó≠Ïù¥ ÌôúÎ∞úÌï¥Ï†∏ Í≤ΩÏ†úÍ∞Ä ÌÅ¨Í≤å Î∞úÏ†ÑÌïòÍ≥† ÏûàÏäµÎãàÎã§.",
                effects: { economy: 18, culture: 8 },
                probability: 0.13
            },
            {
                title: "ÌïôÏûêÎì§Ïù¥ Î™®Ïó¨Îì§ÏóàÏäµÎãàÎã§",
                description: "Ïú†Î™ÖÌïú ÌïôÏûêÎì§Ïù¥ ÏßÑÏòÅÏóê Ìï©Î•òÌïòÏó¨ Î¨∏ÌôîÍ∞Ä Î∞úÎã¨ÌïòÍ≥† ÏûàÏäµÎãàÎã§.",
                effects: { culture: 20, economy: 5 },
                probability: 0.11
            },
            {
                title: "ÏûêÏó∞Ïû¨Ìï¥Í∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§",
                description: "ÌôçÏàòÏôÄ Í∞ÄÎ≠ÑÏúºÎ°ú Ïù∏Ìï¥ ÌÅ∞ ÌîºÌï¥Î•º ÏûÖÏóàÏäµÎãàÎã§.",
                effects: { economy: -12, military: -8 },
                probability: 0.08
            },
            {
                title: "Î∞òÎûÄÏù¥ ÏùºÏñ¥ÎÇ¨ÏäµÎãàÎã§",
                description: "ÏùºÎ∂Ä ÏßÄÏó≠ÏóêÏÑú Î∞òÎûÄÏù¥ Î∞úÏÉùÌïòÏó¨ ÏßÑÏïïÏóê ÎÇòÏÑúÏïº Ìï©ÎãàÎã§.",
                effects: { military: -15, culture: -10 },
                probability: 0.07
            },
            {
                title: "ÏÉàÎ°úÏö¥ Í∏∞Ïà†Ïù¥ Í∞úÎ∞úÎêòÏóàÏäµÎãàÎã§",
                description: "ÎÜçÏóÖÍ≥º Íµ∞ÏÇ¨ Í∏∞Ïà†Ïùò Î∞úÏ†ÑÏúºÎ°ú Íµ≠Î†•Ïù¥ Ìñ•ÏÉÅÎêòÏóàÏäµÎãàÎã§.",
                effects: { military: 10, economy: 12, culture: 8 },
                probability: 0.09
            },
            {
                title: "Ïô∏Íµê ÏÑ±Í≥µ",
                description: "Ï£ºÎ≥Ä ÏÑ∏Î†•Í≥ºÏùò Ïô∏ÍµêÍ∞Ä ÏÑ±Í≥µÌïòÏó¨ ÌèâÌôîÎ°úÏö¥ ÏãúÍ∏∞Î•º ÎßûÏïòÏäµÎãàÎã§.",
                effects: { economy: 10, culture: 15 },
                probability: 0.1
            },
            {
                title: "Íµ∞ÏÇ¨ ÌõàÎ†® Í∞ïÌôî",
                description: "Ï≤¥Í≥ÑÏ†ÅÏù∏ Íµ∞ÏÇ¨ ÌõàÎ†®ÏúºÎ°ú Î≥ëÏÇ¨Îì§Ïùò Ïã§Î†•Ïù¥ Ìñ•ÏÉÅÎêòÏóàÏäµÎãàÎã§.",
                effects: { military: 12, culture: 3 },
                probability: 0.12
            }
        ];

        let gameState = {
            selectedFaction: null,
            turn: 1,
            territories: {},
            gameStarted: false,
            stats: {
                wei: { military: 70, economy: 80, culture: 75 },
                shu: { military: 75, economy: 70, culture: 85 },
                wu: { military: 80, economy: 85, culture: 70 }
            },
            recentEvents: []
        };

        // Í≤åÏûÑ Ï¥àÍ∏∞Ìôî
        function initializeGame() {
            const map = document.getElementById('gameMap');
            map.innerHTML = '';
            
            // 144Í∞ú Ïπ∏ ÏÉùÏÑ± (12x12)
            for (let i = 0; i < 144; i++) {
                const territory = document.createElement('div');
                territory.className = 'territory neutral';
                territory.textContent = territories[i];
                territory.dataset.index = i;
                territory.onclick = () => captureTerritory(i);
                map.appendChild(territory);
                
                // Ï¥àÍ∏∞ ÏßÑÏòÅ Î∞∞Ïπò (Í∞ÅÍ∞Å 48Í∞úÏî©)
                if (i < 48) {
                    gameState.territories[i] = 'wei';
                    territory.className = 'territory wei';
                } else if (i < 96) {
                    gameState.territories[i] = 'shu';
                    territory.className = 'territory shu';
                } else {
                    gameState.territories[i] = 'wu';
                    territory.className = 'territory wu';
                }
            }
            
            updateUI();
            updateStatsDisplay();
        }

        // ÏßÑÏòÅ ÏÑ†ÌÉù
        function selectFaction(faction) {
            gameState.selectedFaction = faction;
            gameState.gameStarted = true;
            
            // Î≤ÑÌäº Ïä§ÌÉÄÏùº ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelectorAll('.faction-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`.faction-btn.${faction}`).classList.add('selected');
            
            updateCapturableAreas();
            updateStatusMessage(`${getFactionName(faction)} ÏßÑÏòÅÏùÑ ÏÑ†ÌÉùÌñàÏäµÎãàÎã§! Ï†ÑÎûµÏ†ÅÏúºÎ°ú ÏòÅÌÜ†Î•º ÌôïÏû•ÌïòÏÑ∏Ïöî.`);
        }

        // ÏòÅÌÜ† Ï†êÎ†π (Îä•Î†•Ïπò Í∏∞Î∞ò)
        function captureTerritory(index) {
            if (!gameState.selectedFaction || !gameState.gameStarted) {
                updateStatusMessage('Î®ºÏ†Ä ÏßÑÏòÅÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî!');
                return;
            }

            const territory = document.querySelector(`[data-index="${index}"]`);
            if (!territory.classList.contains('capturable')) {
                updateStatusMessage('Ïù∏Ï†ëÌïú ÎïÖÎßå Ï†êÎ†πÌï† Ïàò ÏûàÏäµÎãàÎã§!');
                return;
            }

            const currentOwner = gameState.territories[index];
            const playerStats = gameState.stats[gameState.selectedFaction];
            const enemyStats = gameState.stats[currentOwner];
            
            // Ï†ÑÌà¨Î†• Í≥ÑÏÇ∞ (Íµ∞ÏÇ¨Î†• + Í≤ΩÏ†úÎ†•*0.3 + Î¨∏ÌôîÎ†•*0.2)
            const playerPower = playerStats.military + playerStats.economy * 0.3 + playerStats.culture * 0.2;
            const enemyPower = enemyStats.military + enemyStats.economy * 0.3 + enemyStats.culture * 0.2;
            
            // ÏäπÎ¶¨ ÌôïÎ•† Í≥ÑÏÇ∞
            const winChance = playerPower / (playerPower + enemyPower);
            const randomValue = Math.random();
            
            if (randomValue < winChance) {
                // ÏäπÎ¶¨
                gameState.territories[index] = gameState.selectedFaction;
                territory.className = `territory ${gameState.selectedFaction}`;
                updateStatusMessage(`${territories[index]}ÏùÑ(Î•º) ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†êÎ†πÌñàÏäµÎãàÎã§!`);
                
                // ÏäπÎ¶¨ Î≥¥ÏÉÅ
                gameState.stats[gameState.selectedFaction].military += 2;
                gameState.stats[gameState.selectedFaction].economy += 1;
            } else {
                // Ìå®Î∞∞
                updateStatusMessage(`${territories[index]} Ï†êÎ†πÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. Ï†ÅÏùò Ï†ÄÌï≠Ïù¥ Í∞ïÌï©ÎãàÎã§.`);
                
                // Ìå®Î∞∞ ÌéòÎÑêÌã∞
                gameState.stats[gameState.selectedFaction].military -= 3;
            }
            
            updateUI();
            updateStatsDisplay();
            
            // Îã§Ïùå ÌÑ¥ÏúºÎ°ú
            setTimeout(() => {
                nextTurn();
            }, 1500);
        }

        // Îã§Ïùå ÌÑ¥
        function nextTurn() {
            if (!gameState.gameStarted) return;
            
            gameState.turn++;
            
            // Ïù¥Î≤§Ìä∏ Î∞úÏÉù (30% ÌôïÎ•†)
            if (Math.random() < 0.3) {
                triggerRandomEvent();
            }
            
            // AI ÌÑ¥
            aiTurn();
            
            // Îä•Î†•Ïπò ÏûêÏó∞ ÌöåÎ≥µ/Í∞êÏÜå
            Object.keys(gameState.stats).forEach(faction => {
                const stats = gameState.stats[faction];
                const territoryCount = Object.values(gameState.territories).filter(t => t === faction).length;
                
                // ÏòÅÌÜ† ÏàòÏóê Îî∞Î•∏ Î≥¥ÎÑàÏä§/ÌéòÎÑêÌã∞
                const territoryBonus = Math.floor(territoryCount / 20);
                stats.economy += territoryBonus;
                stats.culture += Math.floor(territoryBonus / 2);
                
                // Îä•Î†•Ïπò ÏÉÅÌïú/ÌïòÌïú Ï†ÅÏö©
                stats.military = Math.max(10, Math.min(100, stats.military));
                stats.economy = Math.max(10, Math.min(100, stats.economy));
                stats.culture = Math.max(10, Math.min(100, stats.culture));
            });
            
            updateCapturableAreas();
            updateStatsDisplay();
            checkGameEnd();
        }

        // ÎûúÎç§ Ïù¥Î≤§Ìä∏ Î∞úÏÉù
        function triggerRandomEvent() {
            const availableEvents = gameEvents.filter(event => Math.random() < event.probability);
            if (availableEvents.length === 0) return;
            
            const event = availableEvents[Math.floor(Math.random() * availableEvents.length)];
            const affectedFaction = ['wei', 'shu', 'wu'][Math.floor(Math.random() * 3)];
            
            // Ïù¥Î≤§Ìä∏ Ìö®Í≥º Ï†ÅÏö©
            Object.keys(event.effects).forEach(stat => {
                gameState.stats[affectedFaction][stat] += event.effects[stat];
                gameState.stats[affectedFaction][stat] = Math.max(10, Math.min(100, gameState.stats[affectedFaction][stat]));
            });
            
            // Ïù¥Î≤§Ìä∏ Í∏∞Î°ù
            const eventRecord = {
                ...event,
                faction: affectedFaction,
                turn: gameState.turn
            };
            
            gameState.recentEvents.unshift(eventRecord);
            if (gameState.recentEvents.length > 5) {
                gameState.recentEvents.pop();
            }
            
            updateEventsDisplay();
            updateStatusMessage(`${getFactionName(affectedFaction)}Ïóê "${event.title}" Ïù¥Î≤§Ìä∏Í∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§!`);
        }

        // AI ÌÑ¥
        function aiTurn() {
            const factions = ['wei', 'shu', 'wu'].filter(f => f !== gameState.selectedFaction);
            
            factions.forEach((faction, index) => {
                setTimeout(() => {
                    const capturableAreas = getCapturableAreasForFaction(faction);
                    if (capturableAreas.length > 0) {
                        // AIÎäî Í∞ÄÏû• ÏïΩÌïú Ï†ÅÏùÑ Ïö∞ÏÑ† Í≥µÍ≤©
                        const bestTarget = capturableAreas.reduce((best, current) => {
                            const currentOwner = gameState.territories[current];
                            const bestOwner = gameState.territories[best];
                            
                            if (!currentOwner) return current;
                            if (!bestOwner) return best;
                            
                            const currentPower = getTotalPower(currentOwner);
                            const bestPower = getTotalPower(bestOwner);
                            
                            return currentPower < bestPower ? current : best;
                        });
                        
                        // AI Ï†ÑÌà¨ Í≥ÑÏÇ∞
                        const aiStats = gameState.stats[faction];
                        const targetOwner = gameState.territories[bestTarget];
                        const enemyStats = gameState.stats[targetOwner];
                        
                        const aiPower = getTotalPower(faction);
                        const enemyPower = getTotalPower(targetOwner);
                        
                        const winChance = aiPower / (aiPower + enemyPower);
                        
                        if (Math.random() < winChance) {
                            gameState.territories[bestTarget] = faction;
                            const territory = document.querySelector(`[data-index="${bestTarget}"]`);
                            territory.className = `territory ${faction}`;
                            
                            // AI ÏäπÎ¶¨ Î≥¥ÏÉÅ
                            gameState.stats[faction].military += 1;
                        } else {
                            // AI Ìå®Î∞∞ ÌéòÎÑêÌã∞
                            gameState.stats[faction].military -= 2;
                        }
                    }
                    
                    if (index === factions.length - 1) {
                        updateUI();
                        updateStatsDisplay();
                    }
                }, (index + 1) * 500);
            });
        }

        // Ï¥ù Ï†ÑÌà¨Î†• Í≥ÑÏÇ∞
        function getTotalPower(faction) {
            const stats = gameState.stats[faction];
            return stats.military + stats.economy * 0.3 + stats.culture * 0.2;
        }

        // Ï†êÎ†π Í∞ÄÎä•Ìïú ÏßÄÏó≠ ÌëúÏãú
        function updateCapturableAreas() {
            if (!gameState.selectedFaction) return;
            
            // Î™®Îì† capturable ÌÅ¥ÎûòÏä§ Ï†úÍ±∞
            document.querySelectorAll('.territory').forEach(t => {
                t.classList.remove('capturable');
            });
            
            // ÏÑ†ÌÉùÎêú ÏßÑÏòÅÏù¥ Ï†êÎ†π Í∞ÄÎä•Ìïú ÏßÄÏó≠ ÌëúÏãú
            const capturableAreas = getCapturableAreasForFaction(gameState.selectedFaction);
            capturableAreas.forEach(index => {
                const territory = document.querySelector(`[data-index="${index}"]`);
                territory.classList.add('capturable');
            });
        }

        // ÌäπÏ†ï ÏßÑÏòÅÏù¥ Ï†êÎ†π Í∞ÄÎä•Ìïú ÏßÄÏó≠ Ï∞æÍ∏∞
        function getCapturableAreasForFaction(faction) {
            const capturableAreas = [];
            
            for (let i = 0; i < 144; i++) {
                if (gameState.territories[i] === faction) continue;
                
                // Ïù∏Ï†ëÌïú Ïπ∏ ÌôïÏù∏
                const adjacentIndices = getAdjacentIndices(i);
                const hasAdjacentTerritory = adjacentIndices.some(adjIndex => 
                    gameState.territories[adjIndex] === faction
                );
                
                if (hasAdjacentTerritory) {
                    capturableAreas.push(i);
                }
            }
            
            return capturableAreas;
        }

        // Ïù∏Ï†ëÌïú Ïπ∏Ïùò Ïù∏Îç±Ïä§ Íµ¨ÌïòÍ∏∞
        function getAdjacentIndices(index) {
            const row = Math.floor(index / 12);
            const col = index % 12;
            const adjacent = [];
            
            // ÏÉÅÌïòÏ¢åÏö∞ ÌôïÏù∏
            if (row > 0) adjacent.push(index - 12); // ÏúÑ
            if (row < 11) adjacent.push(index + 12); // ÏïÑÎûò
            if (col > 0) adjacent.push(index - 1); // ÏôºÏ™Ω
            if (col < 11) adjacent.push(index + 1); // Ïò§Î•∏Ï™Ω
            
            return adjacent;
        }

        // Îä•Î†•Ïπò ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateStatsDisplay() {
            const statsContainer = document.getElementById('factionStats');
            statsContainer.innerHTML = '';
            
            Object.keys(gameState.stats).forEach(faction => {
                const stats = gameState.stats[faction];
                const factionDiv = document.createElement('div');
                factionDiv.style.marginBottom = '20px';
                factionDiv.style.padding = '15px';
                factionDiv.style.background = 'rgba(255,255,255,0.05)';
                factionDiv.style.borderRadius = '8px';
                factionDiv.style.border = gameState.selectedFaction === faction ? '2px solid #ffd700' : '1px solid rgba(255,255,255,0.2)';
                
                factionDiv.innerHTML = `
                    <h4 style="color: #ffd700; margin-bottom: 10px; text-align: center;">${getFactionName(faction)}</h4>
                    <div class="stat-item">
                        <div class="stat-name">‚öîÔ∏è Íµ∞ÏÇ¨Î†•</div>
                        <div class="stat-value">${stats.military}</div>
                        <div class="stat-bar">
                            <div class="stat-fill military" style="width: ${stats.military}%"></div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">üí∞ Í≤ΩÏ†úÎ†•</div>
                        <div class="stat-value">${stats.economy}</div>
                        <div class="stat-bar">
                            <div class="stat-fill economy" style="width: ${stats.economy}%"></div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">üìö Î¨∏ÌôîÎ†•</div>
                        <div class="stat-value">${stats.culture}</div>
                        <div class="stat-bar">
                            <div class="stat-fill culture" style="width: ${stats.culture}%"></div>
                        </div>
                    </div>
                `;
                
                statsContainer.appendChild(factionDiv);
            });
        }

        // Ïù¥Î≤§Ìä∏ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
        function updateEventsDisplay() {
            const eventsContainer = document.getElementById('eventsList');
            eventsContainer.innerHTML = '';
            
            if (gameState.recentEvents.length === 0) {
                eventsContainer.innerHTML = '<p style="text-align: center; color: #888;">ÏïÑÏßÅ Î∞úÏÉùÌïú ÏÇ¨Í±¥Ïù¥ ÏóÜÏäµÎãàÎã§.</p>';
                return;
            }
            
            gameState.recentEvents.forEach(event => {
                const eventDiv = document.createElement('div');
                eventDiv.className = 'event-item';
                
                const effectsHtml = Object.keys(event.effects).map(stat => {
                    const value = event.effects[stat];
                    const isPositive = value > 0;
                    const statName = stat === 'military' ? '‚öîÔ∏è' : stat === 'economy' ? 'üí∞' : 'üìö';
                    return `<span class="effect ${isPositive ? 'positive' : 'negative'}">${statName}${isPositive ? '+' : ''}${value}</span>`;
                }).join('');
                
                eventDiv.innerHTML = `
                    <div class="event-title">${event.title}</div>
                    <div class="event-description">${event.description}</div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div class="event-effects">${effectsHtml}</div>
                        <small style="color: #888;">${getFactionName(event.faction)} - ${event.turn}ÌÑ¥</small>
                    </div>
                `;
                
                eventsContainer.appendChild(eventDiv);
            });
        }

        // UI ÏóÖÎç∞Ïù¥Ìä∏
        function updateUI() {
            const counts = { wei: 0, shu: 0, wu: 0 };
            
            Object.values(gameState.territories).forEach(faction => {
                counts[faction]++;
            });
            
            document.getElementById('wei-count').textContent = counts.wei;
            document.getElementById('shu-count').textContent = counts.shu;
            document.getElementById('wu-count').textContent = counts.wu;
        }

        // Í≤åÏûÑ Ï¢ÖÎ£å ÌôïÏù∏
        function checkGameEnd() {
            const counts = { wei: 0, shu: 0, wu: 0 };
            Object.values(gameState.territories).forEach(faction => {
                counts[faction]++;
            });
            
            const totalTerritories = Object.keys(gameState.territories).length;
            const winThreshold = Math.floor(totalTerritories * 0.6); // 60% Ïù¥ÏÉÅ Ï†êÎ†πÏãú ÏäπÎ¶¨
            
            for (const [faction, count] of Object.entries(counts)) {
                if (count >= winThreshold) {
                    updateStatusMessage(`üéâ ${getFactionName(faction)} ÏßÑÏòÅÏù¥ Ï≤úÌïòÎ•º ÌÜµÏùºÌñàÏäµÎãàÎã§! üéâ`);
                    gameState.gameStarted = false;
                    return;
                }
            }
            
            // 50ÌÑ¥ Ïù¥ÌõÑÏóêÎäî Îä•Î†•Ïπò Ìï©Í≥ÑÎ°ú ÏäπÎ∂Ä Í≤∞Ï†ï
            if (gameState.turn >= 50) {
                const powerRanking = Object.keys(gameState.stats).map(faction => ({
                    faction,
                    power: getTotalPower(faction),
                    territories: counts[faction]
                })).sort((a, b) => (b.power + b.territories * 2) - (a.power + a.territories * 2));
                
                const winner = powerRanking[0];
                updateStatusMessage(`üéâ ${getFactionName(winner.faction)} ÏßÑÏòÅÏù¥ ÏµúÍ∞ïÏùò ÏÑ∏Î†•ÏúºÎ°ú ÏäπÎ¶¨ÌñàÏäµÎãàÎã§! üéâ`);
                gameState.gameStarted = false;
            }
        }

        // ÏßÑÏòÅ Ïù¥Î¶Ñ Î∞òÌôò
        function getFactionName(faction) {
            const names = { wei: 'ÏúÑ(È≠è)', shu: 'Ï¥â(ËúÄ)', wu: 'Ïò§(Âê≥)' };
            return names[faction];
        }

        // ÏÉÅÌÉú Î©îÏãúÏßÄ ÏóÖÎç∞Ïù¥Ìä∏
        function updateStatusMessage(message) {
            document.getElementById('statusMessage').textContent = message;
        }

        // Í≤åÏûÑ Î¶¨ÏÖã
        function resetGame() {
            gameState = {
                selectedFaction: null,
                turn: 1,
                territories: {},
                gameStarted: false,
                stats: {
                    wei: { military: 70, economy: 80, culture: 75 },
                    shu: { military: 75, economy: 70, culture: 85 },
                    wu: { military: 80, economy: 85, culture: 70 }
                },
                recentEvents: []
            };
            
            document.querySelectorAll('.faction-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            initializeGame();
            updateEventsDisplay();
            updateStatusMessage('ÏßÑÏòÅÏùÑ ÏÑ†ÌÉùÌïòÍ≥† Ï†ÑÎûµÏ†ÅÏúºÎ°ú Ï≤úÌïòÌÜµÏùºÏùÑ Ïù¥Î£®Ïñ¥Î≥¥ÏÑ∏Ïöî!');
        }

        // ÏûêÎèô ÏßÑÌñâ
        function autoPlay() {
            if (!gameState.gameStarted) {
                updateStatusMessage('Î®ºÏ†Ä ÏßÑÏòÅÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî!');
                return;
            }
            
            const interval = setInterval(() => {
                if (!gameState.gameStarted) {
                    clearInterval(interval);
                    return;
                }
                
                nextTurn();
            }, 2000);
        }

        // Í≤åÏûÑ ÏãúÏûë
        initializeGame();
        updateEventsDisplay();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'983fc9e0a4e70d05',t:'MTc1ODY5MDc2NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
